# ๐ฌ Chแปง ฤแป: [Xแปญ lรฝ SQL]
๐ **Ngรy:** [2025-11-13]  
๐ก **Nhรณm chแปง ฤแป:** [SQL Server]  
โ๏ธ **Nguแปn:** ChatGPT - phiรชn trao ฤแปi hแปc tแบญp cรก nhรขn  

---

## ๐ข Mแปฅc tiรชu buแปi chat
Tรณm tแบฏt ngแบฏn gแปn:  
ROUND(,2) mร sao nรณ vแบซn ra rแบฅt nhiแปu sแป 0 phรญ sau bแบกn ร: 21.900000000000

Hi bแบกn hiแปn, lแปi nรy 99% lร do bแบกn ฤang ROUND mแปt biแปu thแปฉc nhฦฐng kแบฟt quแบฃ vแบซn lร kiแปu DECIMAL cรณ ฤแป chรญnh xรกc rแบฅt lแปn, hoแบทc bแบกn ฤang convert sang NVARCHAR mร khรดng format.

Mรฌnh cแบงn xem ฤoแบกn code cแปงa bแบกn, nhฦฐng trฦฐแปc khi bแบกn gแปญi, mรฌnh nรณi trฦฐแปc 3 nguyรชn nhรขn phแป biแบฟn nhแบฅt:
---

## ๐ง Nแปi dung chรญnh (Trao ฤแปi vแปi ChatGPT)
โ 1. ROUND() vแบซn trแบฃ vแป dแบกng DECIMAL cรณ nhiแปu chแปฏ sแป sau dแบฅu phแบฉy

Vรญ dแปฅ:

ROUND(21.9, 2)


Kแบฟt quแบฃ nแปi bแป vแบซn lร decimal(38, 2), nhฦฐng khi bแบกn:

cแปng vแปi chuแปi

convert sang kiแปu khรกc

hoแบทc select tแปซ mแปt biแปu thแปฉc phแปฉc tแบกp

thรฌ SQL cรณ thแป "mแป rแปng" ฤแป dรi, vร bแบกn thแบฅy:

21.900000000000

โ Cรกch fix chuแบฉn: รฉp kiแปu sau khi ROUND
Cรกch 1 โ CAST sang DECIMAL(10,2)
CAST(ROUND(@Value, 2) AS DECIMAL(10,2))


โ Kแบฟt quแบฃ chแบฏc chแบฏn lร: 21.90

Cรกch 2 โ FORMAT ฤแบนp (SQL 2012+)

Nแบฟu bแบกn muแปn trแบฃ ra dแบกng hiแปn thแป giแปng ngฦฐแปi ฤแปc:
```
FORMAT(ROUND(@Value, 2), 'N2')
```

โ Kแบฟt quแบฃ: 21.90

Cรกch 3 โ Convert sang VARCHAR nhฦฐng giแปฏ 2 sแป
```
CONVERT(VARCHAR(20), ROUND(@Value, 2))
```

Nแบฟu vแบซn bแป kรฉo dรi โ รฉp kiแปu trฦฐแปc:
```
CONVERT(VARCHAR(20), CAST(ROUND(@Value, 2) AS DECIMAL(10,2)))
```
๐ 2. Bแบกn ฤang tรญnh toรกn tแปท lแป rแปi nhรขn chia โ SQL tแปฑ ฤแบฉy vแป kiแปu FLOAT

Nแบฟu trong biแปu thแปฉc cรณ 1 giรก trแป FLOAT thรฌ kแบฟt quแบฃ sแบฝ FLOAT โ FLOAT luรดn cรณ 000000 ฤuรดi.

Fix: รฉp mแปi thแปฉ vแป DECIMAL trฦฐแปc khi ROUND.

๐ 3. Bแบกn gรกn vรo cแปt NVARCHAR trong SELECT

Nแบฟu bแบกn lรm:
```
SELECT MoTaTangTruong = ROUND(...,2)
```

SQL sแบฝ tแปฑ convert ROUND(...) thรnh NVARCHAR vแปi full precision.

Fix:
```
SELECT 
    MoTaTangTruong = CONVERT(VARCHAR(30), CAST(ROUND(..., 2) AS DECIMAL(10,2)))
```
โ Cรกch sแปญa chuแบฉn nhแบฅt

โก๏ธ รp kiแปu vแป DECIMAL(10,2) trฦฐแปc rแปi mแปi CAST sang NVARCHAR

Cรดng thแปฉc chuแบฉn:
```
CAST(
    CAST(ROUND( ... , 2) AS DECIMAL(10,2))
AS NVARCHAR(50))
```

Nhฦฐ vแบญy SQL sแบฝ hiแปn thแป ฤรบng:
```
21.90
-3.52
0.00
```
๐ Vรฌ sao phแบฃi dรนng 2 lแบงn CAST?

ROUND โ cho ra kiแปu DECIMAL nhฦฐng cรณ precision rแปng
CAST(... AS DECIMAL(10,2)) โ rรบt gแปn cรฒn ฤรบng 2 sแป
CAST(... AS NVARCHAR) โ chuyแปn sang chuแปi ฤรบng ฤแปnh dแบกng, khรดng bแป kรฉo dรi

Nแบฟu bแบกn muแปn format ฤแบนp hฦกn (cรณ dแบฅu phแบฉy 1.234,56)
Mรฌnh cรณ thแป thรชm FORMAT:
```
FORMAT(ROUND(...), 'N2', 'vi-VN')
```
## ๐งฉ Ghi chรบ quan trแปng
